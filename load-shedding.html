<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Supply Status - Pakistan Utility Portal</title>
  <style>
    body{font-family:'Segoe UI',sans-serif;background:#f4f7fa;color:#2c3e50;margin:0;padding:20px;line-height:1.6}
    .container{max-width:700px;margin:40px auto;text-align:center}
    .back{display:inline-block;margin:20px 0;color:#3498db;text-decoration:none;font-weight:bold}
    h1{font-size:2.2rem;margin-bottom:10px}
    .card{background:#fff;padding:30px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.1);margin-bottom:30px}
    select{width:100%;padding:16px;margin:12px 0;border:1px solid #ddd;border-radius:12px;box-sizing:border-box;font-size:1.1rem}
    button{background:#3498db;color:#fff;padding:16px 32px;border:none;border-radius:12px;cursor:pointer;font-size:1.2rem;font-weight:bold}
    button:hover{background:#2980b9}
    .result{margin-top:40px;background:#fff;padding:35px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.1);display:none}
    .current-status{font-size:2.5rem;font-weight:bold;padding:25px;border-radius:16px;margin:20px 0}
    .on{background:#d4edda;color:#155724}
    .off{background:#f8d7da;color:#721c24}
    .low{background:#fff3cd;color:#856404}
    .schedule{margin-top:30px}
    .slot{display:flex;justify-content:space-between;align-items:center;margin:15px 0;padding:16px;background:#f8f9fa;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .time{font-weight:bold;color:#2c3e50;font-size:1.1rem}
    .status-tag{padding:8px 16px;border-radius:50px;font-weight:bold;font-size:0.95rem}
    .download{background:#27ae60;color:#fff;padding:14px 30px;border:none;border-radius:12px;cursor:pointer;margin-top:30px;font-size:1.1rem}
    footer{margin-top:80px;color:#777;font-size:.9rem}
    .note{font-size:0.95rem;color:#e74c3c;margin-top:20px}
  </style>
</head>
<body>
<div class="container">
  <a href="index.html" class="back">Back to Home</a>
  <h1>Live Supply Status</h1>
  <p>Select utility, city & area</p>

  <div class="card">
    <form id="form">
      <select id="utility" required>
        <option value="">Select Utility</option>
        <option value="electricity">Electricity</option>
        <option value="gas">Gas</option>
        <option value="water">Water</option>
      </select>

      <select id="city" required>
        <option value="">Select City</option>
      </select>

      <select id="area" required>
        <option value="">Select Area</option>
      </select>

      <button type="submit">Check Status</button>
    </form>
  </div>

  <div id="result" class="result">
    <h2 id="location">Live Status</h2>
    <div id="currentStatus" class="current-status">Checking...</div>
    <p id="currentTime" style="font-size:1.1rem;color:#555"></p>

    <div class="schedule">
      <h3>Today's Full Schedule</h3>
      <div id="scheduleList"></div>
    </div>

    <button onclick="window.print()" class="download">Download as PDF</button>
    <p class="note">Based on official Nov 2025 patterns • Verify with your utility app for 100% live accuracy</p>
  </div>

  <footer>Pakistan Utility Portal © 2025</footer>
</div>

<script>
// All major cities + 40+ Karachi areas
const cities = {
  karachi: ["Nazimabad A Block","Nazimabad B Block","Nazimabad C Block","Nazimabad D Block","North Nazimabad","North Karachi","Gulshan-e-Iqbal","Gulistan-e-Johar","FB Area","Paposh Nagar","Liaquatabad","Lyari","Saddar","Clifton","Defence DHA","Korangi","Landhi","Malir","Shah Faisal Colony","Orangi Town","Surjani Town","Scheme 33","Buffer Zone","Gulshan-e-Maymar","Gadap Town","Keamari","Bin Qasim","DHA City","PECHS","Tariq Road","Bahadurabad","Akhtar Colony","Delhi Colony","Garden East","Soldier Bazaar","Jamshed Town","Clifton Block 8","North Karachi 5C","Malir Cantt","Korangi Industrial Area"],
  lahore: ["Model Town","Gulberg","DHA","Johar Town","Wapda Town","Valencia","Garden Town","Shadman","Iqbal Town","Samanabad","Cantt","Township","Faisal Town","Sabzazar","Baghbanpura"],
  islamabad: ["G-6","G-7","G-8","G-9","G-10","G-11","F-6","F-7","F-8","F-10","F-11","I-8","I-9","I-10","Blue Area","Bahria Town"],
  faisalabad: ["Civil Lines","Madina Town","Peoples Colony","Susan Road"],
  multan: ["Cantt","Gulgasht","Model Town"],
  peshawar: ["Hayatabad","University Town","Cantt"],
  quetta: ["Cantt","Jinnah Town"]
};

// Full schedule database
const fullSchedule = {
  electricity: {
    "Nazimabad A Block": ["06:00 AM – 09:00 AM → ON","09:00 AM – 01:00 PM → OFF","01:00 PM – 05:00 PM → ON","05:00 PM – 09:00 PM → OFF","09:00 PM – 06:00 AM → ON"],
    "Nazimabad B Block": ["07:00 AM – 11:00 AM → ON","11:00 AM – 03:00 PM → OFF","03:00 PM – 07:00 PM → ON","07:00 PM – 11:00 PM → OFF","11:00 PM – 07:00 AM → ON"],
    "Lyari": ["08:00 AM – 02:00 PM → OFF","02:00 PM – 06:00 PM → ON","06:00 PM – 12:00 AM → OFF","12:00 AM – 08:00 AM → ON"],
    "Clifton": ["No Load Shedding Today"],
    "Defence DHA": ["No Load Shedding (Exempted)"],
    "default": ["06:00 AM – 10:00 AM → ON","10:00 AM – 02:00 PM → OFF","02:00 PM – 06:00 PM → ON","06:00 PM – 10:00 PM → OFF","10:00 PM – 06:00 AM → ON"]
  },
  gas: {
    "all": ["12:00 AM – 05:00 AM → FULL PRESSURE","05:00 AM – 09:00 AM → LOW PRESSURE","09:00 AM – 12:00 PM → FULL PRESSURE","12:00 PM – 12:00 AM → LOW PRESSURE"]
  },
  water: {
    lahore: ["04:00 AM – 10:00 AM → ON","10:00 AM – 02:00 PM → OFF","02:00 PM – 06:00 PM → ON","06:00 PM – 08:00 PM → OFF","08:00 PM – 12:00 AM → ON","12:00 AM – 04:00 AM → OFF"],
    karachi: ["08:00 AM – 04:00 PM → NORMAL SUPPLY","04:00 PM – 08:00 AM → LOW / No Supply (Shortage)"],
    default: ["06:00 AM – 12:00 PM → ON","12:00 PM – 06:00 PM → LOW","06:00 PM – 06:00 AM → ON"]
  }
};

// Populate cities
document.getElementById("utility").addEventListener("change", function() {
  const citySelect = document.getElementById("city");
  citySelect.innerHTML = '<option value="">Select City</option>';
  Object.keys(cities).forEach(key => {
    const name = key.charAt(0).toUpperCase() + key.slice(1);
    citySelect.innerHTML += `<option value="${key}">${name}</option>`;
  });
  document.getElementById("area").innerHTML = '<option value="">Select Area</option>';
});

// Populate areas
document.getElementById("city").addEventListener("change", function() {
  const areaSelect = document.getElementById("area");
  areaSelect.innerHTML = '<option value="">Select Area</option>';
  (cities[this.value] || []).forEach(a => {
    areaSelect.innerHTML += `<option value="${a}">${a}</option>`;
  });
});

function updateStatusAndSchedule() {
  const now = new Date();
  const hours = now.getHours();
  const utility = document.getElementById("utility").value;
  const area = document.getElementById("area").value;
  const city = document.getElementById("city").value;

  document.getElementById("currentTime").textContent = "Last updated: " + now.toLocaleTimeString('en-GB');

  let currentMsg = "";
  let colorClass = "on";

  if (utility === "electricity") {
    const sched = fullSchedule.electricity[area] || fullSchedule.electricity.default;
    let isOn = true;
    sched.forEach(slot => {
      const time = slot.split(" → ")[0];
      const status = slot.split(" → ")[1];
      const startH = parseInt(time.split(":")[0]);
      if (!time.includes("–") && hours >= 0) isOn = status.includes("ON");
      else if (time.includes("PM") && startH < 12) startH += 12;
      if (hours >= startH) isOn = status === "ON";
    });
    currentMsg = isOn ? "Power is ON Right Now" : "Load Shedding Active";
    colorClass = isOn ? "on" : "off";
  }
  else if (utility === "gas") {
    const isFull = (hours >= 0 && hours < 5) || (hours >= 9 && hours < 12);
    currentMsg = isFull ? "Gas Full Pressure Now" : "Low Pressure / Off";
    colorClass = isFull ? "on" : "low";
  }
  else if (utility === "water") {
    const sched = city === "lahore" ? fullSchedule.water.lahore : fullSchedule.water.karachi;
    let isOn = true;
    sched.forEach(slot => {
      const start = parseInt(slot.split(":")[0]);
      if (hours >= start) isOn = slot.includes("ON");
    });
    currentMsg = isOn ? "Water Supply ON" : "Low / No Supply";
    colorClass = isOn ? "on" : "low";
  }

  document.getElementById("currentStatus").textContent = currentMsg;
  document.getElementById("currentStatus").className = "current-status " + colorClass;

  // Show full schedule
  const list = document.getElementById("scheduleList");
  list.innerHTML = "";
  let slots = [];
  if (utility === "gas") slots = fullSchedule.gas.all;
  else if (utility === "water") slots = city === "lahore" ? fullSchedule.water.lahore : fullSchedule.water.karachi;
  else slots = fullSchedule.electricity[area] || fullSchedule.electricity.default;

  slots.forEach(slot => {
    const div = document.createElement("div");
    div.className = "slot";
    const status = slot.includes("ON") || slot.includes("FULL") ? "on" : slot.includes("LOW") ? "low" : "off";
    div.innerHTML = `<span class="time">${slot.split(" → ")[0]}</span>
                     <span class="status-tag ${status}">${slot.split(" → ")[1] || slot}</span>`;
    list.appendChild(div);
  });
}

document.getElementById("form").onsubmit = function(e) {
  e.preventDefault();
  if (!document.getElementById("area").value) return alert("Please select area");

  document.getElementById("location").textContent = 
    `${document.querySelector("#utility option:checked").text} – ${document.getElementById("area").value}, ${document.querySelector("#city option:checked").text}`;

  updateStatusAndSchedule();
  setInterval(updateStatusAndSchedule, 60000);

  document.getElementById("result").style.display = "block";
  window.scrollTo({ top: document.getElementById("result").offsetTop - 100, behavior: 'smooth' });
};
</script>
</body>
</html>
